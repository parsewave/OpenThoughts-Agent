# These environment variables are not sourced in the `.sbatch`. Instead they are read in
# the login node's `launch.py` logic and selectively pass to the `.sbatch` so they export
# it explicitly.

# For accessing scripts that live under the OpenThoughts-Agent repo (e.g. `start_ray_server.sh`)
# TODO(Charlie): is this needed? Can we just make sure people run things under `OpenThoughts-Agent` folder
export DC_AGENT=PATH_TO_YOUR_DC_AGENT
export DC_AGENT_TRAIN=$DC_AGENT/train

# Change to your own scratch directory (used for the cache paths below)
export SCRATCH_DIR=$SCRATCH

# For setting user group
export DC_AGENT_GROUP=G-827553

# Env vars used to specify where we pre-download models and datasets to in `pre_download_dataset.py`
export HF_HUB_CACHE=$SCRATCH/hub
export MODELS_DIR=$HF_HUB_CACHE
export DATASETS_DIR=$HF_HUB_CACHE

# Paths to various cache / config directories (feel free to set it to your own $SCRATCH)
export VLLM_CACHE_ROOT=$SCRATCH_DIR/vllm_cache
export VLLM_CONFIG_ROOT=$SCRATCH_DIR/vllm_config
export TRITON_DUMP_DIR=$SCRATCH_DIR/triton_dump_dir
export TRITON_OVERRIDE_DIR=$SCRATCH_DIR/triton_override_dir
export TRITON_CACHE_DIR=$SCRATCH_DIR/triton_cache_dir
export FLASHINFER_WORKSPACE_BASE=$SCRATCH_DIR/flashinfer_cache
export UV_CACHE_DIR=$SCRATCH_DIR/uv_cache_dir

# The source code of SkyRL to use TODO(Charlie): check how this relates to the conda environment
export SKYRL_HOME=/scratch/10000/eguha3/SkyRL

# Conda environment to source and activate in the compute node (to be sourced/activate in .sbatch)
export CONDA_ACTIVATE_PATH=/scratch/08002/gsmyrnis/miniconda3/etc/profile.d/conda.sh
export CONDA_ENV_PATH=/scratch/08134/negin/OpenThoughts-Agent-shared/SkyRL/envs/tacc_rl_v5

# Will be prepended to the compute node's PYTHONPATH. Useful for using your local SkyRL or Harbor repos.
export EXTRA_PYTHONPATH=/scratch/11151/charlieruan/harbor/src

# Environment file for secrets (e.g. API keys) -- point to an external file
if [ -n "${DC_AGENT_SECRET_ENV:-}" ] && [ -f "${DC_AGENT_SECRET_ENV}" ]; then
    export SECRET_ENV_PATH="${DC_AGENT_SECRET_ENV}"
else
    unset SECRET_ENV_PATH
    echo "[OpenThoughts-Agent] WARNING: DC_AGENT_SECRET_ENV not set or file missing; secrets will not be loaded." >&2
fi
